gt_sps.h

#ifndef __GT_SPS_H__
#define __GT_SPS_H__

#include "gt_frame.h"
#include "gt_l2_base.h"
#include "gt_itf_stack_if.h"

#ifdef __cplusplus
extern "C" {
#endif

#define MAX_SPS_RATIO 0.7

typedef struct {
    gt_u8 frm[6]; // 48 bit
    gt_u8 reserved[2];
} GtFrmRes;

typedef struct {
    GtFrmRes data[GT_SUB_CARRI_MAX]; // 0-18 and 20-38
    gt_u8 usedCarriNum;
    gt_u8 reserved[3];
} GtResData;

typedef struct {
    gt_u8 carriIndex;
    gt_u8 reserved[3];
    GtFrmRes res;      // 当前子载波索引对应的时域资源
} SpsCarriInfo;

typedef struct {
    gt_u32 usedCarriNum;            // 当前T节点SPS占用的子载波数目
    SpsCarriInfo *usedCarriArray;   // 当前T节点SPS占用的子载波数组
} SpsUsedCarriInfo;

typedef struct {
    SamplingRate r;          // 采样率
    SamplingLen l;           // 采样深度，即第一类业务每个采样时刻的信息bit数
    gt_u8 numOfMic;          // T节点上麦克的数量，目前固定为1
    gt_u8 srModulationOrder; // 半静态调度的调制阶数
                             // 取值为[2,4,6,8,10] -- QPSK(2^2) 16QAM(2^4) 64QAM(2^6) 256QAM(2^8) 1024QAM(2^10)
    gt_u8 reserved[2];
    double codeRate;         // 半静态调度的码率
} SpsInputParamType1;

typedef struct {
    SrChannelCoding fec;
    SrModulation modulation; // 调制方式
    gt_u8 freqResType1[5];   // 频域位置
    gt_u8 frameSymbolInfo;   // 无线帧内时域位置
    gt_u8 dmrsTimeRes[12];   // DMRS位置
    gt_u8 framePeriod;       // 无线帧间距
    gt_u8 frameOffset;       // 首次分配资源的无线帧编号
} SpsOutputParamXrc;

typedef struct {
    SpsOutputParamXrc xrc;           // 用于XRC生成配置信令
    gt_u8 tbSize;                    // 第一类业务的TB块大小
    gt_u8 reserved[3];
    DciResBitMap activeDciPos;       // 半静态激活DCI的资源位置
    DciSpsActive_60 activeDci;       // 半静态激活DCI内容
    TNodeStatus status;              // T节点(下行或上行)激活，去激活状态
    SpsUsedCarriInfo usedCarri;      // T节点SPS占用的资源信息(用于维测)
} SpsOutputParamType1;

#ifdef __cplusplus
}
#endif

#endif // __GT_SPS_H__

